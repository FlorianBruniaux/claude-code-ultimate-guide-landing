---
import Layout from '../../layouts/Layout.astro'

const title = 'Claude Code Templates: Agents, Hooks, Skills | Free'
const description = 'Browse production-ready Claude Code templates: agents, commands, hooks, skills. One-click copy with syntax highlighting.'

const jsonLd = [
  {
    "@type": "ItemList",
    "name": "Claude Code Templates Collection",
    "description": "113 production-ready templates for Claude Code",
    "numberOfItems": 113,
    "author": {"@type": "Person", "name": "Florian BRUNIAUX"}
  },
  {
    "@type": "HowTo",
    "name": "How to Use Claude Code Templates",
    "description": "Learn how to install and use Claude Code templates for agents, commands, hooks, and skills",
    "step": [
      { "@type": "HowToStep", "name": "Browse templates", "text": "Browse the 113 production-ready templates organized by category: agents, commands, hooks, skills, and more." },
      { "@type": "HowToStep", "name": "Copy template code", "text": "Click the Copy button to copy the template code to your clipboard." },
      { "@type": "HowToStep", "name": "Create target directory", "text": "Create the appropriate directory in your project: .claude/agents/, .claude/commands/, .claude/hooks/, or .claude/skills/" },
      { "@type": "HowToStep", "name": "Paste and customize", "text": "Paste the template into a new file and customize it for your project needs." }
    ]
  }
]
---

<Layout title={title} description={description} jsonLd={jsonLd}>
  <!-- Highlight.js CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

  <div class="container">
    <header class="examples-header">
      <h1>Examples Catalog</h1>
      <p class="subtitle">113 production-ready templates for Claude Code</p>
      <p style="color: var(--text-secondary); max-width: 700px; margin: var(--space-md) auto 0; font-size: 0.95rem;">
        Copy and customize these AI coding assistant templates for your projects. Includes custom agents, slash commands, event-driven hooks, and reusable skills for automated code review, test generation, and security audits.
      </p>
    </header>

    <div class="search-bar">
      <input type="text" class="search-input" id="searchInput" placeholder="Search examples... (press / to focus)" autocomplete="off">
    </div>

    <div class="stats" id="stats"></div>

    <main id="catalog"></main>

    <div id="noResults" class="no-results" style="display: none;">
      <div class="no-results-icon">?</div>
      <p>No examples found matching your search.</p>
    </div>
  </div>

  <div class="toast" id="toast">Copied to clipboard!</div>

  <style>
    .examples-header {
      text-align: center;
      padding: var(--space-3xl) 0 var(--space-xl);
    }

    .examples-header h1 {
      font-size: 2.5rem;
      margin-bottom: var(--space-sm);
    }

    .examples-header .subtitle {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    .search-bar {
      display: flex;
      gap: var(--space-md);
      margin: var(--space-xl) auto;
      max-width: 600px;
    }

    .search-input {
      flex: 1;
      padding: 0.75rem 1rem;
      background-color: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: var(--border-radius);
      color: var(--text-primary);
      font-size: 1rem;
      font-family: var(--font-sans);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.3);
    }

    .search-input::placeholder { color: var(--text-muted); }

    .stats {
      display: flex;
      gap: var(--space-xl);
      justify-content: center;
      margin-bottom: var(--space-xl);
      flex-wrap: wrap;
    }

    .stat { text-align: center; }
    .stat-number { font-size: 1.5rem; font-weight: 600; color: var(--accent); }
    .stat-label { color: var(--text-secondary); font-size: 0.875rem; }

    .category {
      margin-bottom: var(--space-lg);
      background-color: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: var(--border-radius-lg);
      overflow: hidden;
    }

    .category-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-md) var(--space-lg);
      cursor: pointer;
      user-select: none;
      transition: background-color var(--transition-fast);
    }

    .category-header:hover { background-color: var(--bg-tertiary); }

    .category-title {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .category-icon { font-size: 1.25rem; }

    .category-count {
      background-color: var(--bg-tertiary);
      color: var(--text-secondary);
      padding: 0.125rem 0.5rem;
      border-radius: 10px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .category-toggle { color: var(--text-secondary); transition: transform 0.2s; }
    .category.expanded .category-toggle { transform: rotate(186deg); }
    .category-content { display: none; border-top: 1px solid var(--border); }
    .category.expanded .category-content { display: block; }

    .category-description {
      padding: 0.75rem var(--space-lg);
      color: var(--text-secondary);
      font-size: 0.875rem;
      background-color: var(--bg-tertiary);
    }

    .file-list { list-style: none; }
    .file-item { border-bottom: 1px solid var(--border-light); }
    .file-item:last-child { border-bottom: none; }

    .file-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem var(--space-lg);
      gap: var(--space-md);
    }

    .file-info { flex: 1; min-width: 0; }

    .file-name {
      font-family: var(--font-mono);
      font-size: 0.875rem;
      color: var(--accent);
      text-decoration: none;
    }

    .file-name:hover { text-decoration: underline; }

    .favorite-badge {
      color: #f85149;
      font-size: 0.9rem;
      margin-left: 0.5rem;
      animation: pulse-heart 2s ease-in-out infinite;
    }

    @keyframes pulse-heart {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.1); }
    }

    .file-description {
      font-size: 0.8125rem;
      color: var(--text-secondary);
      margin-top: 0.25rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .file-actions { display: flex; gap: var(--space-sm); flex-shrink: 0; }

    .examples-page .btn {
      padding: 0.375rem 0.75rem;
      border-radius: var(--border-radius);
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-fast);
      border: 1px solid var(--border);
      background-color: var(--bg-tertiary);
      color: var(--text-primary);
      font-family: var(--font-sans);
    }

    .examples-page .btn:hover { background-color: var(--border); }
    .btn-view { background-color: transparent; }
    .btn-view.active { background-color: var(--accent); border-color: var(--accent); color: white; }
    .btn-copy { background-color: var(--accent-secondary); border-color: var(--accent-secondary); color: white; }
    .btn-copy:hover { background-color: var(--accent-secondary-hover); }
    .btn-copy.copied { background-color: #a392f7; border-color: #a392f7; }
    .btn-download { background-color: transparent; color: var(--text-secondary); }

    .file-content { display: none; padding: 0; background-color: var(--bg-primary); border-top: 1px solid var(--border-light); }
    .file-item.viewing .file-content { display: block; }

    .file-content pre {
      margin: 0;
      padding: var(--space-md) var(--space-lg);
      overflow-x: auto;
      font-size: 0.8125rem;
      line-height: 1.6;
    }

    .file-content code { font-family: var(--font-mono); background: none; padding: 0; }

    .toast {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background-color: var(--accent-secondary);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: var(--border-radius);
      font-weight: 500;
      opacity: 0;
      transition: all 0.3s;
      z-index: 1000;
    }

    .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

    .no-results { text-align: center; padding: var(--space-3xl); color: var(--text-secondary); }
    .no-results-icon { font-size: 3rem; margin-bottom: var(--space-md); }

    @media (max-width: 640px) {
      .examples-header h1 { font-size: 1.75rem; }
      .stats { gap: var(--space-md); }
      .file-header { flex-wrap: wrap; }
      .file-actions { width: 100%; justify-content: flex-end; margin-top: var(--space-sm); }
    }
  </style>

  <script>
    import hljs from 'highlight.js/lib/core';
    import markdown from 'highlight.js/lib/languages/markdown';
    import json from 'highlight.js/lib/languages/json';
    import yaml from 'highlight.js/lib/languages/yaml';
    import bash from 'highlight.js/lib/languages/bash';
    import powershell from 'highlight.js/lib/languages/powershell';
    import plaintext from 'highlight.js/lib/languages/plaintext';
    import { EXAMPLES } from '../../data/examples-data';

    hljs.registerLanguage('markdown', markdown);
    hljs.registerLanguage('json', json);
    hljs.registerLanguage('yaml', yaml);
    hljs.registerLanguage('bash', bash);
    hljs.registerLanguage('powershell', powershell);
    hljs.registerLanguage('plaintext', plaintext);

    const RAW_BASE = 'https://raw.githubusercontent.com/FlorianBruniaux/claude-code-ultimate-guide/main/examples/';
    const GITHUB_BASE = 'https://github.com/FlorianBruniaux/claude-code-ultimate-guide/blob/main/examples/';

    let contentCache = {};
    let expandedCategories = new Set();

    const catalogEl = document.getElementById('catalog');
    const statsEl = document.getElementById('stats');
    const searchInput = document.getElementById('searchInput');
    const noResultsEl = document.getElementById('noResults');
    const toastEl = document.getElementById('toast');

    function getLanguage(filename) {
      const ext = filename.split('.').pop().toLowerCase();
      const langMap = { 'md': 'markdown', 'json': 'json', 'yml': 'yaml', 'yaml': 'yaml', 'sh': 'bash', 'ps1': 'powershell', 'gitignore': 'plaintext', 'gitignore-claude': 'plaintext' };
      return langMap[ext] || 'plaintext';
    }

    function showToast(message) { toastEl.textContent = message; toastEl.classList.add('show'); setTimeout(() => toastEl.classList.remove('show'), 2000); }

    async function loadContent(path) {
      if (contentCache[path]) return contentCache[path];
      try { const response = await fetch(RAW_BASE + path); if (!response.ok) throw new Error('Failed to load'); const text = await response.text(); contentCache[path] = text; return text; }
      catch (error) { return `Error loading file: ${error.message}\n\nTry viewing on GitHub: ${GITHUB_BASE + path}`; }
    }

    async function copyToClipboard(path) {
      const content = await loadContent(path);
      try { await navigator.clipboard.writeText(content); showToast('Copied to clipboard!'); return true; }
      catch (error) { showToast('Failed to copy'); return false; }
    }

    function downloadFile(path, filename) {
      const url = RAW_BASE + path; const a = document.createElement('a'); a.href = url; a.download = filename; a.target = '_blank';
      document.body.appendChild(a); a.click(); document.body.removeChild(a);
    }

    async function toggleView(path, contentEl, viewBtn) {
      const fileItem = contentEl.closest('.file-item');
      const isViewing = fileItem.classList.contains('viewing');
      if (isViewing) { fileItem.classList.remove('viewing'); viewBtn.classList.remove('active'); viewBtn.textContent = 'View'; }
      else {
        viewBtn.textContent = '...';
        const content = await loadContent(path); const filename = path.split('/').pop(); const language = getLanguage(filename);
        contentEl.innerHTML = `<pre><code class="language-${language}">${escapeHtml(content)}</code></pre>`;
        hljs.highlightElement(contentEl.querySelector('code'));
        fileItem.classList.add('viewing'); viewBtn.classList.add('active'); viewBtn.textContent = 'Hide';
      }
    }

    function escapeHtml(text) { const div = document.createElement('div'); div.textContent = text; return div.innerHTML; }

    function renderStats() {
      let totalFiles = 0; let totalFavorites = 0; let totalCategories = Object.keys(EXAMPLES).length;
      Object.values(EXAMPLES).forEach(cat => { totalFiles += cat.files.length; totalFavorites += cat.files.filter(f => f.favorite).length; });
      statsEl.innerHTML = `<div class="stat"><div class="stat-number">${totalFiles}</div><div class="stat-label">Templates</div></div><div class="stat"><div class="stat-number">${totalCategories}</div><div class="stat-label">Categories</div></div><div class="stat"><div class="stat-number" style="color: #f85149;">${totalFavorites}</div><div class="stat-label">Recommended</div></div>`;
    }

    function renderCatalog(filter) {
      filter = filter || '';
      const filterLower = filter.toLowerCase();
      let html = ''; let hasResults = false;
      Object.entries(EXAMPLES).forEach(([categoryId, category]) => {
        const filteredFiles = category.files.filter(file => file.name.toLowerCase().includes(filterLower) || file.description.toLowerCase().includes(filterLower) || categoryId.toLowerCase().includes(filterLower));
        if (filteredFiles.length === 0) return;
        hasResults = true;
        const isExpanded = expandedCategories.has(categoryId) || filter !== '';
        const categoryName = category.label || categoryId.replace(/-/g, ' ').replace(/(^|\s)\S/g, t => t.toUpperCase());
        html += `<div class="category ${isExpanded ? 'expanded' : ''}" data-category="${categoryId}"><div class="category-header" onclick="toggleCategory('${categoryId}')"><div class="category-title"><span class="category-icon">${category.icon}</span><span>${categoryName}</span><span class="category-count">${filteredFiles.length}</span></div><span class="category-toggle">&#9660;</span></div><div class="category-content"><div class="category-description">${category.description}</div><ul class="file-list">${filteredFiles.map(file => `<li class="file-item" data-path="${file.path}"><div class="file-header"><div class="file-info"><a class="file-name" href="${GITHUB_BASE + file.path}" target="_blank" rel="noopener">${file.name}</a>${file.favorite ? '<span class="favorite-badge" title="Recommended">&#10084;&#65039;</span>' : ''}<div class="file-description">${file.description}</div></div><div class="file-actions"><button class="btn btn-view" onclick="handleView('${file.path}', this)">View</button><button class="btn btn-copy" onclick="handleCopy('${file.path}', this)">Copy</button><button class="btn btn-download" onclick="downloadFile('${file.path}', '${file.name}')" title="Download">&#8595;</button></div></div><div class="file-content"></div></li>`).join('')}</ul></div></div>`;
      });
      catalogEl.innerHTML = html;
      noResultsEl.style.display = hasResults ? 'none' : 'block';
    }

    function toggleCategory(categoryId) {
      if (expandedCategories.has(categoryId)) expandedCategories.delete(categoryId);
      else expandedCategories.add(categoryId);
      renderCatalog(searchInput.value);
    }

    async function handleView(path, btn) {
      const fileItem = btn.closest('.file-item'); const contentEl = fileItem.querySelector('.file-content');
      await toggleView(path, contentEl, btn);
    }

    async function handleCopy(path, btn) {
      const originalText = btn.textContent; btn.textContent = '...';
      const success = await copyToClipboard(path);
      if (success) { btn.textContent = 'âœ“'; btn.classList.add('copied'); setTimeout(() => { btn.textContent = originalText; btn.classList.remove('copied'); }, 1500); }
      else { btn.textContent = originalText; }
    }

    let debounceTimer;
    searchInput.addEventListener('input', (e) => { clearTimeout(debounceTimer); debounceTimer = setTimeout(() => renderCatalog(e.target.value), 150); });

    document.addEventListener('keydown', (e) => {
      if (e.key === '/' && document.activeElement !== searchInput) { e.preventDefault(); searchInput.focus(); }
      if (e.key === 'Escape') { searchInput.blur(); searchInput.value = ''; renderCatalog(''); }
    });

    function handleHashNavigation() {
      const hash = window.location.hash.replace('#', '');
      if (hash && EXAMPLES[hash]) {
        expandedCategories.add(hash); renderCatalog();
        requestAnimationFrame(() => { const categoryEl = document.querySelector(`[data-category="${hash}"]`); if (categoryEl) categoryEl.scrollIntoView({ behavior: 'smooth', block: 'start' }); });
      }
    }

    renderStats(); renderCatalog(); handleHashNavigation();
    window.addEventListener('hashchange', handleHashNavigation);
  </script>
</Layout>
